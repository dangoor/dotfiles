#!/bin/bash

{{- if .codespaces }}
set -e

echo "Installing packages for Codespaces..."

# Install apt packages

sudo apt update && sudo apt-get install -y bat fd-find ripgrep

# Install fzf from GitHub releases
FZF_VERSION="v0.67.0"
FZF_URL="https://github.com/junegunn/fzf/releases/download/${FZF_VERSION}/fzf-${FZF_VERSION:1}-linux_amd64.tar.gz"

echo "Installing fzf ${FZF_VERSION}..."
cd /tmp
curl -fsSL "${FZF_URL}" -o fzf.tar.gz
tar -xzf fzf.tar.gz
sudo mv fzf /usr/local/bin/
sudo chmod +x /usr/local/bin/fzf
rm fzf.tar.gz
cd -

# Install scmpuff from GitHub releases
SCMPUFF_VERSION="v0.6.0"
SCMPUFF_ARCH="linux_amd64"
SCMPUFF_URL="https://github.com/mroth/scmpuff/releases/download/${SCMPUFF_VERSION}/scmpuff_${SCMPUFF_VERSION:1}_${SCMPUFF_ARCH}.tar.gz"

echo "Installing scmpuff ${SCMPUFF_VERSION}..."
cd /tmp
curl -fsSL "${SCMPUFF_URL}" -o scmpuff.tar.gz
tar -xzf scmpuff.tar.gz
sudo mv scmpuff /usr/local/bin/
sudo chmod +x /usr/local/bin/scmpuff
rm scmpuff.tar.gz
cd -

# Install zoxide
echo "Installing zoxide..."
curl -sSfL https://raw.githubusercontent.com/ajeetdsouza/zoxide/main/install.sh | sh

echo "Installing: mise..."
curl "https://mise.run" | sh

echo "Package installation complete."

{{- else }}
echo "Not running in Codespaces, skipping Linux package installation."
{{- end }}
